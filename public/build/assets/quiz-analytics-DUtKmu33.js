document.addEventListener("DOMContentLoaded",function(){let t=null;window.firebaseAnalytics&&(t=window.firebaseAnalytics);let e={quizId:null,quizTitle:null,currentQuestion:1,totalQuestions:0,startTime:null,endTime:null,answers:[],correctAnswers:0,incorrectAnswers:0,unattempted:0};function r(){var i,o;if(document.getElementById("quiz-container")){const a=((i=document.querySelector("h3"))==null?void 0:i.textContent)||"Unknown Quiz",_=((o=document.querySelector(".total-questions"))==null?void 0:o.textContent)||0;e.quizTitle=a,e.totalQuestions=parseInt(_),e.startTime=new Date,t&&(t.trackQuizInteraction("quiz_started",null,null,a),t.trackUserEngagement("quiz_session_start",{quiz_title:a,total_questions:e.totalQuestions,timestamp:e.startTime.toISOString()}))}}function c(n,i,o=null){t&&(t.trackQuizInteraction("question_attempted",null,n,e.quizTitle),t.trackUserEngagement("question_interaction",{question_number:n,selected_option:i,is_correct:o,quiz_title:e.quizTitle}))}function s(n,i){t&&t.trackUserEngagement("answer_selected",{question_number:n,selected_option:i,quiz_title:e.quizTitle})}function l(n){if(t){const i=new Date,o=(i-e.startTime)/1e3;t.trackQuizInteraction("quiz_completed",null,null,e.quizTitle),t.trackUserEngagement("quiz_completion",{quiz_title:e.quizTitle,total_questions:e.totalQuestions,correct_answers:n.correct||0,incorrect_answers:n.incorrect||0,unattempted:n.unattempted||0,score_percentage:n.scorePercentage||0,duration_seconds:o,timestamp:i.toISOString()})}}function u(){if(t){const n=new Date,i=(n-e.startTime)/1e3;t.trackQuizInteraction("quiz_abandoned",null,null,e.quizTitle),t.trackUserEngagement("quiz_abandonment",{quiz_title:e.quizTitle,current_question:e.currentQuestion,duration_seconds:i,timestamp:n.toISOString()})}}function q(n,i){t&&t.trackUserEngagement("quiz_timer_event",{event_type:n,time_remaining:i,quiz_title:e.quizTitle})}function m(n){t&&t.trackUserEngagement("explanation_viewed",{question_number:n,quiz_title:e.quizTitle})}function z(n,i,o){t&&t.trackUserEngagement("question_navigation",{from_question:n,to_question:i,direction:o,quiz_title:e.quizTitle})}function d(n,i){t&&t.trackUserEngagement("view_mode_interaction",{action:n,question_number:i,quiz_title:e.quizTitle})}r(),window.addEventListener("beforeunload",function(){e.startTime&&!e.endTime&&u()}),window.quizAnalytics={trackQuestionInteraction:c,trackAnswerSelection:s,trackQuizCompletion:l,trackQuizAbandonment:u,trackTimerEvent:q,trackExplanationView:m,trackQuestionNavigation:z,trackViewModeInteraction:d,quizState:e}});
